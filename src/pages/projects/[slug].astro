---
import Layout from "../../layouts/Layout.astro";
import { getCollection, type CollectionEntry } from "astro:content";
import Tag from "../../components/ui/Tag.astro";

type ProjectEntry = CollectionEntry<'projects'>;

export async function getStaticPaths() {
    const projects = await getCollection("projects");
    return projects.map((entry: ProjectEntry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }));
}

const { entry }: { entry: ProjectEntry } = Astro.props;
const { Content } = await entry.render();
---

<Layout title={`${entry.data.title} | Aravind Sanjeev`}>
    <main class="py-24 max-w-full">
        <header class="mb-16 max-w-4xl">
            <h1 class="text-5xl md:text-6xl font-bold text-primary mb-8">
                {entry.data.title}
            </h1>
            <p class="text-2xl text-secondary leading-relaxed mb-8">
                {entry.data.description}
            </p>

            <div class="flex flex-wrap gap-3 mb-10">
                {
                    entry.data.tags?.map((tag: string) => (
                        <Tag title={tag} href={`/tag/${tag.toLowerCase()}`} />
                    ))
                }
            </div>

            {
                entry.data.url && (
                    <a
                        href={entry.data.url}
                        target="_blank"
                        rel="noopener noreferrer"
                        class="inline-flex items-center px-4 py-2 rounded-lg bg-surface text-primary border border-white/10 hover:border-accent/50 transition-colors"
                    >
                        Visit Project
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="20"
                            height="20"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            stroke-width="2"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            class="ml-2"
                        >
                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6" />
                            <polyline points="15 3 21 3 21 9" />
                            <line x1="10" y1="14" x2="21" y2="3" />
                        </svg>
                    </a>
                )
            }
        </header>

        {
            entry.data.imageUrl && (
                <div class="mb-16 rounded-xl overflow-hidden border border-white/5">
                    <img
                        src={entry.data.imageUrl}
                        alt={entry.data.title}
                        class="w-full h-auto"
                    />
                </div>
            )
        }

        <article class="prose prose-invert prose-lg max-w-none">
            <Content />
        </article>
    </main>
</Layout>
