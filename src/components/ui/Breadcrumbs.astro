---
interface Props {
    className?: string;
    customLabel?: string;
}

const { className = "", customLabel } = Astro.props;
const pathname = Astro.url.pathname;
const segments = pathname.split("/").filter(Boolean);

let breadcrumbs = segments.map((segment, index) => {
    const url = `/${segments.slice(0, index + 1).join("/")}`;
    let label = segment
        .split("-")
        .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
        .join(" ");

    // Use custom label for the last segment if provided
    if (customLabel && index === segments.length - 1) {
        label = customLabel;
    }

    return { label, url };
});

// Special case: If we are on a root-level post (1 segment and not 'blog' or 'projects')
// insert "Blog" segment manually.
if (
    segments.length === 1 &&
    segments[0] !== "blog" &&
    segments[0] !== "projects"
) {
    breadcrumbs = [{ label: "Blog", url: "/blog" }, ...breadcrumbs];
}
---

<nav aria-label="Breadcrumb" class={`flex ${className}`}>
    <ol class="flex items-center space-x-2 text-sm text-secondary">
        <li>
            <a href="/" class="hover:text-accent transition-colors">Home</a>
        </li>
        {
            breadcrumbs.map((crumb, index) => (
                <li class="flex items-center space-x-2">
                    <span class="text-secondary/50">/</span>
                    {index === breadcrumbs.length - 1 ? (
                        <span class="text-primary font-medium">
                            {crumb.label}
                        </span>
                    ) : (
                        <a
                            href={crumb.url}
                            class="hover:text-accent transition-colors"
                        >
                            {crumb.label}
                        </a>
                    )}
                </li>
            ))
        }
    </ol>
</nav>
