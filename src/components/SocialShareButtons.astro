---
const { size, post } = Astro.props;
const baseUrl = "https://aravindsanjeev.com";
const link = `${baseUrl}/${post.slug}`;
const title = post.data.title;

// Prepare tags
let tags = [];
if (post.data.tags) {
  try {
     tags = typeof post.data.tags === 'string' ? JSON.parse(post.data.tags) : post.data.tags;
  } catch (e) {
     tags = [];
  }
}
const hashtags = tags.join(',');

const icons = {
  twitter: `<svg viewBox="0 0 64 64" fill="currentColor" height="${size}" width="${size}"><circle cx="32" cy="32" r="31" fill="#1da1f2"></circle><path d="M43.333 22c-1.042.469-2.188.781-3.333.938 1.25-.729 2.188-1.927 2.656-3.281-1.146.677-2.438 1.198-3.802 1.458-1.042-1.146-2.552-1.875-4.219-1.875-3.177 0-5.729 2.552-5.729 5.729 0 .469.052.885.156 1.302-4.792-.208-9.01-2.5-11.823-5.99-.469.833-.781 1.771-.781 2.813 0 2 .99 3.75 2.552 4.792-.938-.052-1.771-.26-2.552-.729v.052c0 2.76 1.979 5.094 4.583 5.625-.469.156-1.042.156-1.563.156-.365 0-.729-.052-1.094-.104.729 2.292 2.865 3.958 5.365 4.01-1.979 1.563-4.427 2.5-7.083 2.5-.469 0-.885-.052-1.354-.104 2.552 1.667 5.573 2.604 8.75 2.604 10.521 0 16.25-8.75 16.25-16.25 0-.26-.01-.521-.021-.781 1.052-.833 2.031-1.875 2.76-3.021z" fill="#fff"></path></svg>`,
  linkedin: `<svg viewBox="0 0 64 64" fill="currentColor" height="${size}" width="${size}"><circle cx="32" cy="32" r="31" fill="#007fb1"></circle><path d="M20.4,44h5.4V26.6h-5.4V44z M23.1,24.3c1.9,0,3.1-1.3,3.1-2.9c0-1.6-1.1-2.9-3.1-2.9 c-1.8,0-3,1.3-3,2.9C20.1,23,21.3,24.3,23.1,24.3z M29.4,44h5.4V34.8c0-0.5,0-1,0.2-1.3c0.4-1,1.3-2,2.8-2c2,0,2.8,1.5,2.8,3.7V44 h5.4V34.5c0-5.1-2.7-7.5-6.3-7.5c-2.9,0-4.2,1.6-4.9,2.7h0.1v-2.3h-5.4c0.1,1.5,0,16.6,0,16.6V44z" fill="#fff"></path></svg>`,
  whatsapp: `<svg viewBox="0 0 64 64" fill="currentColor" height="${size}" width="${size}"><circle cx="32" cy="32" r="31" fill="#25d366"></circle><path d="M42.3,37.3c-0.6-0.3-3.4-1.7-4-1.9c-0.5-0.2-0.9-0.3-1.3,0.3c-0.4,0.6-1.5,1.9-1.9,2.2c-0.3,0.4-0.7,0.4-1.3,0.1 c-0.6-0.3-2.6-1-4.9-3c-1.8-1.6-3-3.5-3.4-4.1c-0.3-0.6,0-0.9,0.3-1.2c0.2-0.2,0.6-0.6,0.9-0.9c0.3-0.3,0.4-0.6,0.6-0.9 c0.2-0.4,0.1-0.7,0-1c-0.1-0.3-0.9-2.2-1.3-3c-0.3-0.8-0.7-0.7-0.9-0.7c-0.2,0-0.5,0-0.8,0c-0.3,0-0.8,0.1-1.2,0.6 c-0.4,0.5-1.6,1.6-1.6,3.8c0,2.2,1.6,4.4,1.8,4.7c0.2,0.3,3.2,4.9,7.7,6.9c2.7,1.2,3.7,1.2,5.1,1c1.2-0.2,3.4-1.4,3.9-2.8 c0.5-1.4,0.5-2.5,0.3-2.8C43,37.7,42.9,37.6,42.3,37.3z M32,18.1c-7.7,0-13.9,6.2-13.9,13.9c0,2.5,0.6,4.8,1.8,6.8l-1.9,6.9 l7.1-1.9c1.9,1,4.2,1.6,6.9,1.6c7.7,0,13.9-6.2,13.9-13.9C45.9,24.4,39.7,18.1,32,18.1z" fill="#fff"></path></svg>`
};

const twitterUrl = `https://twitter.com/intent/tweet?url=${encodeURIComponent(link)}&text=${encodeURIComponent(title)}&hashtags=${hashtags}`;
const linkedinUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(link)}`;
const whatsappUrl = `https://api.whatsapp.com/send?text=${encodeURIComponent(title + " | " + link)}`;
---
<a href={twitterUrl} target="_blank" rel="noopener noreferrer" aria-label="Share on Twitter" class="cursor-pointer">
  <span set:html={icons.twitter} />
</a>
<a href={linkedinUrl} target="_blank" rel="noopener noreferrer" aria-label="Share on LinkedIn" class="cursor-pointer">
  <span set:html={icons.linkedin} />
</a>
<a href={whatsappUrl} target="_blank" rel="noopener noreferrer" aria-label="Share on WhatsApp" class="cursor-pointer">
  <span set:html={icons.whatsapp} />
</a>
